1.  First, we need to define the class that inherits the properties of the auxiliary family.
```ruby
class MetasploitModule < Msf::Post
```
- The module can import several functionalities, such as scanning, opening connections, using the database, and so on.

2. The `include` statement can be used to include a particular functionality of the framework into our own module
```ruby
include Msf::Post::Windows::WMIC
```
- The above statement tells the Metasploit Framework to include all the functions and method defined in the 'Msf::Post::Windows::WMIC' module into our own module. This allows us to call these functions and methods directly from our own code, withour having to define to them ourselves.

3. The following few lines give us an introduction to the module, such as its name, version, author, description, and so on:
```ruby 
class MetasploitModule < Msf::Post
   include Msf::Post::Windows::WMIC

def initialize(info={})
 super(update_info(info,
	 'Name' => 'Windows Gather Run Specified WMIC Command',
	 'Description' => %q{This module will execute a given WMIC command options or read WMIC options from a resource file and execute the commands in the specified Meterpreter session.},
	 'License' => MSF_LICENSE,
	 'Author' => [ 'Carlos Perez<carlos_perez[at]darkoperator.com>'],
	 'Platform' => [ 'win'],
	 'SessionTypes' => [ 'meterpreter' ]
	 ))

	register_options(
	[
		OptPath.new('RESOURCE', [false, 'Full path to resource file to read commands from.']),
		OptString.new('COMMAND', [false, 'WMIC command options.']),
		])
	end
```